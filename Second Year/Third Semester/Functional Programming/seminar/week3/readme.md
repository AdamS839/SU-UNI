# Упражнение 3 - Функции от по-висок ред

### Задача 0 
Напишете функция `compose`, която приема две функции на 1 параметър и връща нова функция - тяхната композиция.

```scheme
(define (5+ x)
  (+ x 5))

(define (3* x)
  (* x 3))

((compose 5+ 3*) 4) ; -> 17
```

### Задача 1
Напишете функция `(flip f)`, която приема двуместна функция като аргумент и връща същата функция, но с разменени места на нейните аргументи:
```
(define f (flip -))
(f 4 10) -> 6 ; = (- 10 4)
((flip f) 4 10) -> -6
```

### Задача 2 
Напишете функция `repeat`, която приема функция `f` и число `n`. Функцията да връща нова функция, която е `n`-кратната композиция на `f`.

```scheme
((repeat (lambda (x) (+ x 1)) 8) 4) ; -> 12
```

### Задача 3
Да се напише функция `(twist k f g)`, която за дадени едноместни функции `f` и `g` и четно число `k` връща функция, еквивалентна на `f(g(f(g(...(x)...))))`, където общият брой извиквания на `f` и `g` е `k`.
```
(define (++ x) (+ x 1))
(define (sq x) (* x x))
(define foo (twist 4 ++ sq))
; това ще смята ((((x^2)+1)^2)+1)
(define bar (twist 2 ++ sq))
; това ще смята ((x^2)+1)
(foo 2) -> 26
(bar 2) -> 5
```
Напишете я използвайки `repeat`, както и без нея.

### Задача 4
Напишете функция `curry`, която приема двуместна функция `f` и я трансформира до функция `g` на един аргумент, връщаща функция на един аргумент, така че `f(a, b) = g(a)(b)`.

```scheme
(((curry +) 5) 7) ; -> 12
((((curry compose) 5+) 3*) 4) ; -> 17
```

## Функцията `accumulate`
За всяка от следващите задачи използвайте само `accumulate`, без да ползвате пряка рекурсия.
```scheme
(define (accumulate operation null-value begin end term next)
  (if (> begin end) null-value
      (operation (term begin)
                 (accumulate operation null-value (next begin) end term next))))
```
### Задача 5
Да се напише функция `(!! n)`, която по дадено естествено число `n` изчислява `n!!` - произведението на всички числа, по-малки или равни на `n`, със същата четност:
```
(!! 5) -> 15    ; =1*3*5
(!! 10) -> 3840 ; =2*4*6*8*10
```

### Задача 6
Напишете функция `sum-odd-squares`, която приема 2 числа - `a` и `b`. Функцията да пресмята сумата на квадратите на нечетните числа в интервала [a, b].

```scheme
(sum-odd-squares 1 10) ; -> 165
```

### Задача 7 
Напишете функция `binomial`, която приема 2 числа - `n` и `k`. Функцията да пресмятa $\binom{n}{k}$.

```scheme
(binomial 8 3) ; -> 56
```

### Задача 8
Напишете функция `argmax`, която приема функция `f` и две числа - `a` и `b`. Функцията да намира това число `x` в интервала [a, b], за което f(x) има най-голяма стойност.

```scheme
(argmax (lambda (x) (remainder x 7)) 45 50) ; -> 48
```

### Задача 9 
Напишете функция `all?`, която приема предикат и две числа - `a` и `b`. Функцията да проверява дали предиката е истина за всички числа в интервала [a, b].

### Задача 9.1
Напишете функция `any?`, която е същата като `all?`, но проверява дали `някое` от числата изпълнява предиката.

```scheme
(all? even? 1 10) ; -> #f
(all? (lambda (z) (< z 11)) 1 10) ; -> #t
```

### Задача 10
Да се напише функцията `(digits-count n)`, която намира броя цифри на естественото число `n`.

### Задача 11
Да се напише функция `(prime? n)`, която проверява дали дадено число е просто:
```
(prime? 1) -> #f ;(!)
(prime? 2) -> #t
(prime? 101) -> #t
```

### Задача 12
Да се напише функцията от по-висок ред `(repeat f n)`, използвайки `accumulate`

### Задача 13
Да се напише функцията от по-висок ред `(twist n f g)`, използвайки `accumulate`


